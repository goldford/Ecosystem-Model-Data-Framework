"0",""
"0","# ////////////////////////////////////////////////////////////////////"
"0","# sum by group within season"
"0","# get average by modelgroup over seasons"
"0",""
"0"," temp1 = df_2_summary %>%"
"0","    group_by(season,modelgroup) %>%"
"0","    summarise(B_mean_g_m2_DW = sum(round(B_mean_g_m2_DW, digits=2)),"
"0","             B_mean_g_m2_WW = sum(round(B_mean_g_m2_WW, digits=2)),"
"0","             B_mean_g_m2_C = sum(round(B_mean_g_m2_C, digits=2)),"
"0","             B_mean_mg_m3_DW = sum(round(B_mean_mg_m3_DW, digits=2)),"
"0","             B_mean_mg_m3_WW = sum(round(B_mean_mg_m3_WW, digits=2)),"
"0","             B_mean_mg_m3_C = sum(round(B_mean_mg_m3_C, digits=2))) %>%"
"0","    arrange(desc(B_mean_g_m2_DW), .by_group = FALSE) %>%"
"0","    mutate(season = factor(season, levels=c(""winter"", ""spring"", ""summer"", ""fall"")))"
"2","`summarise()` has grouped output by 'season'. You can override using the `.groups` argument."
"0","print(""averaging all b across seasons..."")"
"1","[1]"
"1"," ""averaging all b across seasons..."""
"1","
"
"0","n_seasons = 4"
"0","avg_B_modelgroups = temp1 %>%"
"0","    group_by(modelgroup) %>%"
"0","    summarise(B_sum_g_m2_DW = sum(round(B_mean_g_m2_DW, digits=2)),"
"0","             B_sum_g_m2_WW = sum(round(B_mean_g_m2_WW, digits=2)),"
"0","             B_sum_g_m2_C = sum(round(B_mean_g_m2_C, digits=2)),"
"0","             B_sum_mg_m3_DW = sum(round(B_mean_mg_m3_DW, digits=2)),"
"0","             B_sum_mg_m3_WW = sum(round(B_mean_mg_m3_WW, digits=2)),"
"0","             B_sum_mg_m3_C = sum(round(B_mean_mg_m3_C, digits=2))) %>%"
"0","    mutate(B_mean_g_m2_DW = round(B_sum_g_m2_DW / n_seasons, digits=2)) %>%"
"0","    mutate(B_mean_g_m2_WW = round(B_sum_g_m2_WW / n_seasons, digits=2)) %>%"
"0","    mutate(B_mean_g_m2_C = round(B_sum_g_m2_C / n_seasons, digits=2)) %>%"
"0","    mutate(B_mean_mg_m3_DW = round(B_sum_mg_m3_DW / n_seasons, digits=2)) %>%"
"0","    mutate(B_mean_mg_m3_WW = round(B_sum_mg_m3_WW / n_seasons, digits=2)) %>%"
"0","    mutate(B_mean_mg_m3_C = round(B_sum_mg_m3_C / n_seasons, digits=2)) %>%"
"0","    arrange(desc(B_mean_g_m2_DW), .by_group = FALSE) "
"0",""
"0",""
"0","# ////////////////////////////////////////////////////////////////////"
"0","# attempt to adjust for spatial sampling biases (see text)"
"0",""
"0","# ////////////////////////////////////////////////////////////////////"
"0","# calc tow depth range percent of column on average"
"0","# shoudl probably be seasonally stratified but this is quick and just a rough est"
"0","avg_tow_depth_perc = df_2 %>% select(Index, tow_depth_range, Bottom_depth.m.) %>% "
"0","    mutate(tow_depth_range_per = tow_depth_range / Bottom_depth.m.) %>% "
"0","    distinct() %>% "
"0","    summarise(n = n(),"
"0","             tow_depth_range_per_avg = mean(tow_depth_range_per)) %>% "
"0","    pull(tow_depth_range_per_avg)"
"0",""
"0","# ////////////////////////////////////////////////////////////////////"
"0","# adjust for over-estimation due to deep water bias in samples"
"0","# get annual total avg conc"
"0","# WW"
"0","ZC1_EUP_mg_m3_avg_WW = avg_B_modelgroups %>% filter(modelgroup == ""ZC1-EUP"") %>% pull(B_mean_mg_m3_WW)"
"0","ZC2_AMP_mg_m3_avg_WW = avg_B_modelgroups %>% filter(modelgroup == ""ZC2-AMP"") %>% pull(B_mean_mg_m3_WW)"
"0","ZC3_DEC_mg_m3_avg_WW = avg_B_modelgroups %>% filter(modelgroup == ""ZC3-DEC"") %>% pull(B_mean_mg_m3_WW)"
"0","ZC4_CLG_mg_m3_avg_WW = avg_B_modelgroups %>% filter(modelgroup == ""ZC4-CLG"") %>% pull(B_mean_mg_m3_WW)"
"0","ZC5_CSM_mg_m3_avg_WW = avg_B_modelgroups %>% filter(modelgroup == ""ZC5-CSM"") %>% pull(B_mean_mg_m3_WW)"
"0",""
"0","ZS1_JEL_mg_m3_avg_WW = avg_B_modelgroups %>% filter(modelgroup == ""ZS1-JEL"") %>% pull(B_mean_mg_m3_WW)"
"0","ZS2_CTH_mg_m3_avg_WW = avg_B_modelgroups %>% filter(modelgroup == ""ZS2-CTH"") %>% pull(B_mean_mg_m3_WW)"
"0","ZS3_CHA_mg_m3_avg_WW = avg_B_modelgroups %>% filter(modelgroup == ""ZS3-CHA"") %>% pull(B_mean_mg_m3_WW)"
"0","ZS4_LAR_mg_m3_avg_WW = avg_B_modelgroups %>% filter(modelgroup == ""ZS4-LAR"") %>% pull(B_mean_mg_m3_WW)"
"0",""
"0","ZF1_ICH_mg_m3_avg_WW = avg_B_modelgroups %>% filter(modelgroup == ""ZF1-ICH"") %>% pull(B_mean_mg_m3_WW)"
"0","misc_mg_m3_avg_WW = avg_B_modelgroups %>% filter(modelgroup == ""misc"") %>% pull(B_mean_mg_m3_WW)"
"0",""
"0","#carbon"
"0","ZC1_EUP_mg_m3_avg_C = avg_B_modelgroups %>% filter(modelgroup == ""ZC1-EUP"") %>% pull(B_mean_mg_m3_C)"
"0","ZC2_AMP_mg_m3_avg_C = avg_B_modelgroups %>% filter(modelgroup == ""ZC2-AMP"") %>% pull(B_mean_mg_m3_C)"
"0","ZC3_DEC_mg_m3_avg_C = avg_B_modelgroups %>% filter(modelgroup == ""ZC3-DEC"") %>% pull(B_mean_mg_m3_C)"
"0","ZC4_CLG_mg_m3_avg_C = avg_B_modelgroups %>% filter(modelgroup == ""ZC4-CLG"") %>% pull(B_mean_mg_m3_C)"
"0","ZC5_CSM_mg_m3_avg_C = avg_B_modelgroups %>% filter(modelgroup == ""ZC5-CSM"") %>% pull(B_mean_mg_m3_C)"
"0",""
"0","ZS1_JEL_mg_m3_avg_C = avg_B_modelgroups %>% filter(modelgroup == ""ZS1-JEL"") %>% pull(B_mean_mg_m3_C)"
"0","ZS2_CTH_mg_m3_avg_C = avg_B_modelgroups %>% filter(modelgroup == ""ZS2-CTH"") %>% pull(B_mean_mg_m3_C)"
"0","ZS3_CHA_mg_m3_avg_C = avg_B_modelgroups %>% filter(modelgroup == ""ZS3-CHA"") %>% pull(B_mean_mg_m3_C)"
"0","ZS4_LAR_mg_m3_avg_C = avg_B_modelgroups %>% filter(modelgroup == ""ZS4-LAR"") %>% pull(B_mean_mg_m3_C)"
"0",""
"0","ZF1_ICH_mg_m3_avg_C = avg_B_modelgroups %>% filter(modelgroup == ""ZF1-ICH"") %>% pull(B_mean_mg_m3_C)"
"0","misc_mg_m3_avg_C = avg_B_modelgroups %>% filter(modelgroup == ""misc"") %>% pull(B_mean_mg_m3_C)"
"0",""
"0",""
"0","df_depths$ZC1_EUP = 0"
"0","df_depths$ZC2_AMP = 0"
"0","df_depths$ZC3_DEC = 0"
"0","df_depths$ZC4_CLG = 0"
"0","df_depths$ZC5_CSM = 0"
"0",""
"0","df_depths$ZS1_JEL = 0"
"0","df_depths$ZS2_CTH = 0"
"0","df_depths$ZS3_CHA = 0"
"0","df_depths$ZS4_LAR = 0"
"0",""
"0","df_depths$ZF1_FIS = 0"
"0","df_depths$misc = 0"
"0",""
"0","# wet weight"
"0","avg_B_WW_modelgroups_better = df_depths %>%"
"0","    mutate(ZC1_EUP = depth * avg_tow_depth_perc * ZC1_EUP_mg_m3_avg_WW * mg_to_g) %>%"
"0","    mutate(ZC2_AMP = depth * avg_tow_depth_perc * ZC2_AMP_mg_m3_avg_WW * mg_to_g) %>%"
"0","    mutate(ZC3_DEC = depth * avg_tow_depth_perc * ZC3_DEC_mg_m3_avg_WW * mg_to_g) %>%"
"0","    mutate(ZC4_CLG = depth * avg_tow_depth_perc * ZC4_CLG_mg_m3_avg_WW * mg_to_g) %>%"
"0","    mutate(ZC5_CSM = depth * avg_tow_depth_perc * ZC5_CSM_mg_m3_avg_WW * mg_to_g) %>%"
"0","    mutate(ZS1_JEL = depth * avg_tow_depth_perc * ZS1_JEL_mg_m3_avg_WW * mg_to_g) %>%"
"0","    mutate(ZS2_CTH = depth * avg_tow_depth_perc * ZS2_CTH_mg_m3_avg_WW * mg_to_g) %>%"
"0","    mutate(ZS3_CHA = depth * avg_tow_depth_perc * ZS3_CHA_mg_m3_avg_WW * mg_to_g) %>%"
"0","    mutate(ZS4_LAR = depth * avg_tow_depth_perc * ZS4_LAR_mg_m3_avg_WW * mg_to_g) %>%"
"0","    mutate(ZF1_ICH = depth * avg_tow_depth_perc * ZF1_ICH_mg_m3_avg_WW * mg_to_g) %>%"
"0","    mutate(misc = depth * misc_mg_m3_avg_WW * mg_to_g) %>%"
"0","    summarise(ZC1_EUP = round(mean(ZC1_EUP),digits=1),"
"0","             ZC2_AMP = round(mean(ZC2_AMP),digits=1),"
"0","             ZC3_DEC = round(mean(ZC3_DEC),digits=1),"
"0","             ZC4_CLG = round(mean(ZC4_CLG),digits=1),"
"0","             ZC5_CSM = round(mean(ZC5_CSM),digits=1),"
"0","             ZS1_JEL = round(mean(ZS1_JEL),digits=1),"
"0","             ZS2_CTH = round(mean(ZS2_CTH),digits=1),"
"0","             ZS3_CHA = round(mean(ZS3_CHA),digits=1),"
"0","             ZS4_LAR = round(mean(ZS4_LAR),digits=1),"
"0","             ZF1_ICH = round(mean(ZF1_ICH),digits=1),"
"0","             misc = round(mean(misc),digits=1)) %>%"
"0","    pivot_longer(everything(), names_to = ""modelgroup"", values_to = ""B_mean_g_m2_WW"")"
"0",""
"0","# carbon"
"0","avg_B_C_modelgroups_better = df_depths %>%"
"0","    mutate(ZC1_EUP = depth * avg_tow_depth_perc * ZC1_EUP_mg_m3_avg_C * mg_to_g) %>%"
"0","    mutate(ZC2_AMP = depth * avg_tow_depth_perc * ZC2_AMP_mg_m3_avg_C * mg_to_g) %>%"
"0","    mutate(ZC3_DEC = depth * avg_tow_depth_perc * ZC3_DEC_mg_m3_avg_C * mg_to_g) %>%"
"0","    mutate(ZC4_CLG = depth * avg_tow_depth_perc * ZC4_CLG_mg_m3_avg_C * mg_to_g) %>%"
"0","    mutate(ZC5_CSM = depth * avg_tow_depth_perc * ZC5_CSM_mg_m3_avg_C * mg_to_g) %>%"
"0","    mutate(ZS1_JEL = depth * avg_tow_depth_perc * ZS1_JEL_mg_m3_avg_C * mg_to_g) %>%"
"0","    mutate(ZS2_CTH = depth * avg_tow_depth_perc * ZS2_CTH_mg_m3_avg_C * mg_to_g) %>%"
"0","    mutate(ZS3_CHA = depth * avg_tow_depth_perc * ZS3_CHA_mg_m3_avg_C * mg_to_g) %>%"
"0","    mutate(ZS4_LAR = depth * avg_tow_depth_perc * ZS4_LAR_mg_m3_avg_C * mg_to_g) %>%"
"0","    mutate(ZF1_ICH = depth * avg_tow_depth_perc * ZF1_ICH_mg_m3_avg_C * mg_to_g) %>%"
"0","    mutate(misc = depth * misc_mg_m3_avg_C * mg_to_g) %>%"
"0","    summarise(ZC1_EUP = round(mean(ZC1_EUP),digits=3),"
"0","             ZC2_AMP = round(mean(ZC2_AMP),digits=3),"
"0","             ZC3_DEC = round(mean(ZC3_DEC),digits=3),"
"0","             ZC4_CLG = round(mean(ZC4_CLG),digits=3),"
"0","             ZC5_CSM = round(mean(ZC5_CSM),digits=3),"
"0","             ZS1_JEL = round(mean(ZS1_JEL),digits=3),"
"0","             ZS2_CTH = round(mean(ZS2_CTH),digits=3),"
"0","             ZS3_CHA = round(mean(ZS3_CHA),digits=3),"
"0","             ZS4_LAR = round(mean(ZS4_LAR),digits=3),"
"0","             ZF1_ICH = round(mean(ZF1_ICH),digits=3),"
"0","             misc = round(mean(misc),digits=3)) %>%"
"0","    pivot_longer(everything(), names_to = ""modelgroup"", values_to = ""B_mean_g_m2_C"")"
"0",""
"0",""
"0",""
"0","# ////////////////////////////////////////////////////////////////////"
"0","# convert back from WW to DW"
"0","avg_B_WW_modelgroups_better$B_mean_g_m2_DW = 0"
"0","avg_B_WW_modelgroups_better = avg_B_WW_modelgroups_better %>% "
"0","    mutate(B_mean_g_m2_DW = case_when(modelgroup==""ZC1_EUP"" ~ B_mean_g_m2_WW / DW_to_WW_ZC1_EUP,"
"0","                                      modelgroup==""ZC2_AMP"" ~ B_mean_g_m2_WW / DW_to_WW_ZC2_AMP,"
"0","                                      modelgroup==""ZC3_DEC"" ~ B_mean_g_m2_WW / DW_to_WW_ZC3_DEC,"
"0","                                      modelgroup==""ZC4_CLG"" ~ B_mean_g_m2_WW / DW_to_WW_ZC4_CLG,"
"0","                                      modelgroup==""ZC5_CSM"" ~ B_mean_g_m2_WW / DW_to_WW_ZC5_CSM,"
"0","                                      modelgroup==""ZS1_JEL"" ~ B_mean_g_m2_WW / DW_to_WW_ZG1_JEL,"
"0","                                      modelgroup==""ZS2_CTH"" ~ B_mean_g_m2_WW / DW_to_WW_ZG2_CTH,"
"0","                                      modelgroup==""ZS3_CHA"" ~ B_mean_g_m2_WW / DW_to_WW_ZG3_CHA,"
"0","                                      modelgroup==""ZS4_LAR"" ~ B_mean_g_m2_WW / DW_to_WW_ZG4_LAR,"
"0","                                      modelgroup==""ZF1_ICH"" ~ B_mean_g_m2_WW / DW_to_WW_ZF1_ICH,"
"0","                                      modelgroup==""misc"" ~ B_mean_g_m2_WW / DW_to_WW_zoop,"
"0","                                      # else default"
"0","                                      TRUE ~ B_mean_g_m2_WW / DW_to_WW_zoop"
"0","                                 ))"
"0",""
"0",""
"0","# next - need to go back above and figure out how to merge these"
"0","avg_B_WW_modelgroups_better"
