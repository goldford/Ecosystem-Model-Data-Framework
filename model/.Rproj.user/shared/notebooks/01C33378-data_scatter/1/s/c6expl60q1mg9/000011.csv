"0","# to log transform replace .data[[yv]] w/ log(data[[yv]],+.1)"
"0",""
"0","# Specify the variables for scatter plots"
"0","scatter_vars <- c('Eel-like large', 'Elongated large', 'Elongated small', 'Normal large', 'Normal small')"
"0","dcis_vars <- c('S2_DCIs_NoDD','S2_DCIs10kmCu','S2_DCIs1kmCu')"
"0","dcis_labs <- c('DCIs struc.','DCIs func. \n10 km thr.','DCIs func. \n1 km thr.')"
"0",""
"0","plots_list <- list()"
"0",""
"0","i = 1"
"0","for (dcis_var in dcis_vars) {"
"0","  "
"0","#print(scatter_var)"
"0","#plot_data <- result_grp_seg2 %>%"
"0","#  select(dcis_var, scatter_var)"
"0",""
"0","xv = dcis_var"
"0","yv = scatter_vars[[1]]"
"0","x_lab_sct = dcis_labs[[i]]"
"0","if (i == 1) {"
"0","  sctr_ttl = stringr::str_wrap(paste(yv), width=10)"
"0","} else {"
"0","  sctr_ttl = """""
"0","}"
"0",""
"0","pnt_sz = 0.2"
"0","lab_sz = 7"
"0","ttl_sz = 7"
"0",""
"0","# Scatter Plot"
"0","scatter_plot1 <- ggplot(result_grp_seg2, aes(x = .data[[xv]], y = .data[[yv]] )) +"
"0","  geom_point(size=pnt_sz) +"
"0","  labs(title = sctr_ttl, x = """", y = ""Tot. Abun."") + "
"0","  theme("
"0","    text = element_text(size = lab_sz),           # Adjust the overall text size"
"0","    axis.text = element_text(size = lab_sz),      # Adjust the axis text size"
"0","    axis.title = element_text(size = ttl_sz)     # Adjust the axis title size"
"0","  )"
"0",""
"0","yv = scatter_vars[[2]]"
"0","if (i == 1) {"
"0","  sctr_ttl = stringr::str_wrap(paste(yv), width=10)"
"0","} else {"
"0","  sctr_ttl = """""
"0","}"
"0","scatter_plot2 <- ggplot(result_grp_seg2, aes(x = .data[[xv]], y = .data[[yv]] )) +"
"0","  geom_point(size=pnt_sz) +"
"0","  labs(title = sctr_ttl, x = """",y = """") + "
"0","  theme("
"0","    text = element_text(size = lab_sz),           # Adjust the overall text size"
"0","    axis.text = element_text(size = lab_sz),      # Adjust the axis text size"
"0","    axis.title = element_text(size = ttl_sz)     # Adjust the axis title size"
"0","  )"
"0",""
"0","yv = scatter_vars[[3]]"
"0","if (i == 1) {"
"0","  sctr_ttl = stringr::str_wrap(paste(yv), width=10)"
"0","} else {"
"0","  sctr_ttl = """""
"0","}"
"0","scatter_plot3 <- ggplot(result_grp_seg2, aes(x = .data[[xv]], y = .data[[yv]] )) +"
"0","  geom_point(size=pnt_sz) +"
"0","  labs(title = sctr_ttl, x = x_lab_sct,y = """") + "
"0","  theme("
"0","    text = element_text(size = lab_sz),           # Adjust the overall text size"
"0","    axis.text = element_text(size = lab_sz),      # Adjust the axis text size"
"0","    axis.title = element_text(size = ttl_sz)     # Adjust the axis title size"
"0","  )"
"0",""
"0","yv = scatter_vars[[4]]"
"0","if (i == 1) {"
"0","  sctr_ttl = stringr::str_wrap(paste(yv), width=10)"
"0","} else {"
"0","  sctr_ttl = """""
"0","}"
"0","scatter_plot4 <- ggplot(result_grp_seg2, aes(x = .data[[xv]], y = .data[[yv]] )) +"
"0","  geom_point(size=pnt_sz) +"
"0","  labs(title = sctr_ttl, x = """",y = """") + "
"0","  theme("
"0","    text = element_text(size = lab_sz),           # Adjust the overall text size"
"0","    axis.text = element_text(size = lab_sz),      # Adjust the axis text size"
"0","    axis.title = element_text(size = ttl_sz)     # Adjust the axis title size"
"0","  )"
"0",""
"0","yv = scatter_vars[[5]]"
"0","if (i == 1) {"
"0","  sctr_ttl = stringr::str_wrap(paste(yv), width=10)"
"0","} else {"
"0","  sctr_ttl = """""
"0","}"
"0","scatter_plot5 <- ggplot(result_grp_seg2, aes(x = .data[[xv]], y = .data[[yv]] )) +"
"0","  geom_point(size=pnt_sz) +"
"0","  labs(title = sctr_ttl, x = """",y = """") + "
"0","  theme("
"0","    text = element_text(size = lab_sz),           # Adjust the overall text size"
"0","    axis.text = element_text(size = lab_sz),      # Adjust the axis text size"
"0","    axis.title = element_text(size = ttl_sz)     # Adjust the axis title size"
"0","  )"
"0",""
"0","# Histogram"
"0","histogram_plot <- ggplot(result_grp_seg2, aes(x = .data[[xv]])) +"
"0","  geom_histogram(binwidth = 1, fill = ""blue"", color = ""black"", alpha = 0.7) +"
"0","  #labs(title = """", x = xv, y = ""Frequency"") +"
"0","  labs(title = """", x = """", y = ""Frequency"") +"
"0","  theme("
"0","    text = element_text(size = lab_sz),           # Adjust the overall text size"
"0","    axis.text = element_text(size = lab_sz),      # Adjust the axis text size"
"0","    axis.title = element_text(size = ttl_sz)     # Adjust the axis title size"
"0","  )"
"0",""
"0","# Combine the plots"
"0","# Combine the plots using patchwork"
"0","combined_plots <- scatter_plot1 / scatter_plot2 / scatter_plot3 / scatter_plot4 / scatter_plot5 / histogram_plot +"
"0","  plot_layout(ncol = 6, guides = ""collect"", heights = 1)"
"0",""
"0","# Add the combined plot to the list"
"0","plots_list[[paste(yv, dcis_var)]] <- combined_plots"
"0",""
"0","i = i + 1"
"0","}"
"0",""
"0","# Display the combined plot"
"0","print(plots_list)"
"1","$`Normal small S2_DCIs_NoDD`
"
"1","
"
"1","$`Normal small S2_DCIs10kmCu`
"
"1","
"
"1","$`Normal small S2_DCIs1kmCu`
"
"1","
"
